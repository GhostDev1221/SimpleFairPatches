---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/8/24 18:50
---
CustomListener = {}

function CustomListener:init()
    ConsumeTipMsgEvent.registerCallBack(self.onConsumeTipMsg)
    ConsumeDiamondsEvent.registerCallBack(self.onConsumeDiamonds)
end

function CustomListener.onConsumeTipMsg(rakssid, extra, isRight)
    if isRight == false then
        return
    end
    local player = PlayerManager:getPlayerByRakssid(rakssid)
    if player == nil then
        return
    end
    local extras = StringUtil.split(extra, "=")
    if extras[1] == "Ruins.ReBuild" and extras[2] ~= nil then
        local npc = GameManager:getRuins(tonumber(extras[2]))
        if npc then
            npc:onPlayerConfirm(player)
        end
    end
end

function CustomListener.onConsumeDiamonds(rakssid, isSuccess, message, extra)
    if isSuccess == false then
        return
    end
    local player = PlayerManager:getPlayerByRakssid(rakssid)
    if player == nil then
        return
    end
    local extras = StringUtil.split(extra, "=")
    if extras[1] == "Ruins.ReBuild" and extras[2] ~= nil then
        local npc = GameManager:getRuins(tonumber(extras[2]))
        if npc then
            npc:ReBuild(player)
        end
    end
end

return CustomListener