---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/9/5 16:31
---
require "Match"

RealRankUtil = {}

function RealRankUtil:sendRealRankData(player)
    local players = PlayerManager:copyPlayers()
    if #players == 0 then
        return
    end
    table.sort(players, function(a, b)
        if a.kills ~= b.kills then
            return a.kills > b.kills
        end
        if a.dies ~= b.dies then
            return a.dies < b.dies
        end
        return a.userId > b.userId
    end)
    local data = {}
    data.ranks = {}
    for rank, _player in pairs(players) do
        local item = {}
        item.column_1 = tostring(rank)
        item.column_2 = _player.name
        item.column_3 = tostring(_player.kills)
        item.column_4 = tostring(_player.dies)
        data.ranks[rank] = item
        if rank == 3 then
            break
        end
    end
    local ownRank = 10
    for rank, _player in pairs(players) do
        if _player.rakssid == player.rakssid then
            ownRank = rank
            break
        end
    end
    local own = {}
    own.column_1 = tostring(ownRank)
    own.column_2 = player.name
    own.column_3 = tostring(player.kills)
    own.column_4 = tostring(player.dies)
    data.own = own
    HostApi.updateRealTimeRankInfo(player.rakssid, json.encode(data))
end

return RealRankUtil