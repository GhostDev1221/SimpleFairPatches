---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/8/9 17:26
---

require "data.GameSkill"

LogicListener = {}

function LogicListener:init()
    ItemSkillAttackEvent.registerCallBack(self.onItemSkillAttack)
    ItemSkillConsumptionItemEvent.registerCallBack(self.onItemSkillConsumptionItem)
end

function LogicListener.onItemSkillAttack(entityId, itemId, position)
    local player = PlayerManager:getPlayerByEntityId(entityId)
    if player == nil then
        return
    end
    if player.isLife == false then
        return
    end
    local skill = SkillConfig:getSkill(itemId)
    if skill ~= nil then
        GameSkill.new(skill, player, position)
    end
end

function LogicListener.onItemSkillConsumptionItem(rakssid, itemId)
    local player = PlayerManager:getPlayerByRakssid(rakssid)
    if player == nil then
        return
    end

    if itemId == ItemID.ENDER_PEARL then
        player:removeItem(itemId, 1)
    end
end

return LogicListener