---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by work.
--- DateTime: 2018/7/5 15:05
---
GameGetPrivateResource = class()

function GameGetPrivateResource:ctor(resource, initPos, yaw, actor, name)
    self.entityId = 0
    self.resource = resource
    self.initPos = initPos
    self.yaw = yaw
    self.actor = actor
    self.name = name
    self.effect = resource.resource.recNpcEffect
    self:onCreate()
end

function GameGetPrivateResource:onCreate()
    self.entityId = EngineWorld:addActorNpc(self.initPos, self.yaw, self.actor, self.name, "idle", self.effect)
    GameManager:onAddGetResource(self)
    local pos = BasicConfig:getResourceGetPosByBasic(self.resource.domain.basicId, self.initPos)
    EngineWorld:setBlock(pos, 44, 7)
    pos = BasicConfig:getResourceGetPosiByBasic(self.resource.domain.basicId, self.initPos)
    EngineWorld:setBlock(pos, 155, 7)
end

function GameGetPrivateResource:onPlayerHit(player)
    local stealPercent = 0

    if self.resource:isResourcePlayer(player) then
        stealPercent = 1
        self.resource:getResource(player, stealPercent)
        return
    else
        stealPercent = player.stealPercent
    end

    if stealPercent == 0 then
        return
    end
    if player:isGetCd(self.resource.resource.getCd, tostring(self.resource.resource.id)) then
        self.resource:getResource(player, stealPercent)
        player:setResourceRecord(tostring(self.resource.resource.id))
        MsgSender.sendCenterTipsToTarget(self.resource.player.rakssid, 2, Messages:informResourceByStealed(player:getDisplayName()))
    end
end