---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by work.
--- DateTime: 2018/9/5 10:08
---

require "base.util.MerchantUtil"

CommodityConfig = {}
CommodityConfig.commoditys = {}

CommodityConfig.cTypes = {}

CommodityConfig.OccupationUnlock = 0        --职业解锁对应其他icon
CommodityConfig.ArmorUnlock = 1             --皮肤解锁对应装备icon
CommodityConfig.PotionUnlock = 2            --药水解锁对应酿造icon
CommodityConfig.ArmsUnlock = 3              --武器解锁对应武器icon
CommodityConfig.SkillBookUnlock = 4         --技能解锁对应skillbook的icon


function CommodityConfig:initCommoditys(commoditys)
    for id, commodity in pairs(commoditys) do
        local item = {}
        item.type = self:getItemType(tonumber(commodity.type))
        item.desc = commodity.desc
        if commodity.image == "#" then
            item.image = ""
        else
            item.image = commodity.image
        end
        item.id = tonumber(commodity.id)
        item.meta = tonumber(commodity.meta)
        item.num = tonumber(commodity.num)
        item.coinId = tonumber(commodity.coinId)
        item.price = tonumber(commodity.price)
        item.groupId = tonumber(commodity.groupId)
        item.notify = tonumber(commodity.notify)
        self.commoditys[tonumber(id)] = item
    end

    for i, commodity in pairs(self.commoditys) do
        MerchantUtil:addCommodity(commodity.groupId, commodity.type, self:newCommodity(commodity))
    end

end

function CommodityConfig:newCommodity(item)
    local commodity = Commodity.new()
    commodity.itemId = item.id
    commodity.itemMeta = item.meta
    commodity.itemNum = item.num
    commodity.coinId = item.coinId
    commodity.price = item.price
    commodity.desc = item.desc
    commodity.notify = item.notify
    commodity.image = item.image
    return commodity
end

function CommodityConfig:getItemType(type)
    if type == self.OccupationUnlock then
        self.cTypes["5"] = self.OccupationUnlock
        return 5
    elseif type == self.PotionUnlock then
        self.cTypes["15"] = self.PotionUnlock
        return 15
    elseif type == self.ArmsUnlock then
        self.cTypes["2"] = self.ArmsUnlock
        return 2
    elseif type == self.ArmorUnlock then
        self.cTypes["1"] = self.ArmorUnlock
        return 1
    elseif type == self.SkillBookUnlock then
        self.cTypes["11"] = self.SkillBookUnlock
        return 11
    end
    return 5
end

function CommodityConfig:getItemTypeByType(type)
    local t = self.cTypes[tostring(type)]
    if t then
        return t
    end
    return 5
end

return CommodityConfig