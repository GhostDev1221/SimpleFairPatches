---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xiaolai.
--- DateTime: 2018/12/24 18:16
---

require "base.util.VectorUtil"
require "data.GameSite"

SiteConfig = {}
SiteConfig.sites = {}

function SiteConfig:init(sites)
    self:initSites(sites)
end

function SiteConfig:initSites(sites)
    for _, site in pairs(sites) do
        site.id = tonumber(site.id)
        local s = GameSite.new(site)
        table.insert(self.sites, s)
    end
end

function SiteConfig:getSitesById(id)
    for i, v in pairs(self.sites) do
        if v.id == id then
            return v
        end
    end
    return
end

function SiteConfig:sortSites()
    table.sort(self.sites, function(s1, s2)
        if s1.playernum == s2.playernum then
            return s1.id < s2.id
        end
        return s1.playernum > s2.playernum
    end )
end

function SiteConfig:addPlayerToFreeSites(player)
    self:sortSites()
    for i, v in pairs(self.sites) do
        if v.playernum < 2 and v.id ~= player.siteId then
            v:addPlayer(player)
            return v.id
        end
    end
end