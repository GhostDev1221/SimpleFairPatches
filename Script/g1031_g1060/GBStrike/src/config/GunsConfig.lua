---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/9/10 17:49
---
GunsConfig = {}
GunsConfig.guns = {}

function GunsConfig:init(guns)
    self:initGuns(guns)
end

function GunsConfig:initGuns(guns)
    for id, gun in pairs(guns) do
        local item = {}
        item.gunId = id
        item.itemId = tonumber(gun.itemId)
        item.initialItemId = tonumber(gun.initialItemId)
        item.name = gun.name
        item.image = gun.image
        item.type = tonumber(gun.type)
        item.attack = tonumber(gun.attack)
        item.range = tonumber(gun.range)
        item.speed = tonumber(gun.speed)
        item.bulletId = tonumber(gun.bulletId)
        item.maxBullet = tonumber(gun.maxBullet)
        item.knockback = tonumber(gun.knockback)
        item.recoil = tonumber(gun.recoil)
        item.sniperDistance = tonumber(gun.sniperDistance)
        item.bulletPerShoot = tonumber(gun.bulletPerShoot)
        item.bulletOffset = tonumber(gun.bulletOffset)
        item.gunHeadShot = tonumber(gun.gunHeadShot)
        self.guns[id] = item
    end
    self:prepareGuns()
end

function GunsConfig:prepareGuns()
    for i, gun in pairs(self.guns) do
        HostApi.setGunSetting(GunsConfig.newGunSetting(gun))
    end
end

function GunsConfig.newGunSetting(item)
    local setting = GunPluginSetting.new()
    setting.gunId = item.itemId
    setting.gunType = item.type
    setting.maxBulletNum = item.maxBullet
    setting.damage = item.attack
    setting.knockback = item.knockback
    setting.recoil = item.recoil
    setting.bulletId = item.bulletId
    setting.shootRange = item.range
    setting.cdTime = item.speed
    setting.sniperDistance = item.sniperDistance
    setting.bulletPerShoot = item.bulletPerShoot
    setting.bulletOffset = item.bulletOffset
    setting.headshotDamage = item.gunHeadShot
    return setting
end

function GunsConfig:getGuns()
    return self.guns
end

function GunsConfig:getGunById(gunId)
    for i, gun in pairs(self.guns) do
        if gun.gunId == gunId then
            return gun
        end
    end
end

function GunsConfig:getGunByItemId(itemId)
    for i, gun in pairs(self.guns) do
        if gun.itemId == itemId then
            return gun
        end
    end
end

function GunsConfig:getSameGanByInitialItemId(initialItemId)
    local _guns = {}
    for i, v in pairs(self.guns) do
        if initialItemId == v.initialItemId then
            table.insert(_guns, v)
        end
    end
    return _guns
end

return GunsConfig