---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2018/11/16 17:38
---

require "config.Area"
require "util.SkillUtil"
require "data.GamePlayer"

GameSkill = class()

function GameSkill:ctor(config, player, initPos)
    self.itemId = config.itemId
    self.length = config.range
    self.width = config.range
    self.height = config.range
    self.duration = config.duration
    self.effect = config.effect
    self.occupation = config.occupation
    self.player = player
    if self.occupation == GamePlayer.ROLE_SEEK then
        self.initPos = initPos
    else
        self.initPos = player:getPosition()
    end
    self.area = {}
    self:initArea()
    self:doAction()
end

function GameSkill:initArea()
    local matrix = {}
    matrix[1] = {}
    matrix[1][1] = self.initPos.x - self.length
    matrix[1][2] = self.initPos.y - self.height
    matrix[1][3] = self.initPos.z - self.width
    matrix[2] = {}
    matrix[2][1] = self.initPos.x + self.length
    matrix[2][2] = self.initPos.y + self.height
    matrix[2][3] = self.initPos.z + self.width
    self.area = Area.new(matrix)
end

function GameSkill:doAction()
    if self.occupation == GamePlayer.ROLE_SEEK then
        SkillUtil:useGrenades(self.initPos, self.area, self.player, self.effect, self.duration)
    end
    if self.occupation == GamePlayer.ROLE_HIDE then
        SkillUtil:useChangeAnimal(self.area, self.player, self.duration)
    end
end

function GameSkill:onRemove()
    self = {}
end

return GameSkill
